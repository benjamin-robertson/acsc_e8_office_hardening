---
acsc_e8_office_hardening::disable_flash::reg_values:
  HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}\ActivationFilterOverride:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}'
    value: 'ActivationFilterOverride'
    type: 'dword'
    data: '0'
  HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}\Compatibility Flags:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}'
    value: 'Compatibility Flags'
    type: 'dword'
    data: '1024'
  HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}\ActivationFilterOverride:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}'
    value: 'ActivationFilterOverride'
    type: 'dword'
    data: '0'
  HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}\Compatibility Flags:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}'
    value: 'Compatibility Flags'
    type: 'dword'
    data: '1024'
  HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}\ActivationFilterOverride:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}'
    value: 'ActivationFilterOverride'
    type: 'dword'
    data: '0'
  HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}\Compatibility Flags:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}'
    value: 'Compatibility Flags'
    type: 'dword'
    data: '1024'
  HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}\ActivationFilterOverride:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}'
    value: 'ActivationFilterOverride'
    type: 'dword'
    data: '0'
  HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}\Compatibility Flags:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}'
    value: 'Compatibility Flags'
    type: 'dword'
    data: '1024'
  HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}\ActivationFilterOverride:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}'
    value: 'ActivationFilterOverride'
    type: 'dword'
    data: '0'
  HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}\Compatibility Flags:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}'
    value: 'Compatibility Flags'
    type: 'dword'
    data: '1024'
  HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}\ActivationFilterOverride:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}'
    value: 'ActivationFilterOverride'
    type: 'dword'
    data: '0'
  HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}\Compatibility Flags:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}'
    value: 'Compatibility Flags'
    type: 'dword'
    data: '1024'
  HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}\ActivationFilterOverride:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}'
    value: 'ActivationFilterOverride'
    type: 'dword'
    data: '0'
  HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}\Compatibility Flags:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB6E-AE6D-11CF-96B8-444553540000}'
    value: 'Compatibility Flags'
    type: 'dword'
    data: '1024'
  HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}\ActivationFilterOverride:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}'
    value: 'ActivationFilterOverride'
    type: 'dword'
    data: '0'
  HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}\Compatibility Flags:
    key: 'HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Microsoft\Office\16.0\Common\COM Compatibility\{D27CDB70-AE6D-11CF-96B8-444553540000}'
    value: 'Compatibility Flags'
    type: 'dword'
    data: '1024'

acsc_e8_office_hardening::macros::all_disabled:
  software\policies\microsoft\office\common\security\automationsecurity:
    class: 'user'
    key: 'software\policies\microsoft\office\common\security'
    value: 'automationsecurity'
    type: 'dword'
    data: '3'
  software\policies\microsoft\office\16.0\common\vbaoff:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\common'
    value: 'vbaoff'
    type: 'dword'
    data: '1'
  software\policies\microsoft\office\16.0\common\security\trusted locations\allow user locations:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\common\security\trusted locations'
    value: 'allow user locations'
    type: 'dword'
    data: '0'
  software\policies\microsoft\office\16.0\excel\security\accessvbom:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security'
    value: 'accessvbom'
    type: 'dword'
    data: '0'
  software\policies\microsoft\office\16.0\excel\security\trusted documents\disabletrusteddocuments:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security\trusted documents'
    value: 'disabletrusteddocuments'
    type: 'dword'
    data: '1'
  software\policies\microsoft\office\16.0\excel\security\trusted documents\disablenetworktrusteddocuments:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security\trusted documents'
    value: 'disablenetworktrusteddocuments'
    type: 'dword'
    data: '1'
  software\policies\microsoft\office\16.0\excel\security\vbawarnings:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security'
    value: 'vbawarnings'
    type: 'dword'
    data: '4'
  software\policies\microsoft\office\16.0\excel\security\trusted locations\allownetworklocations:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security\trusted locations'
    value: 'allownetworklocations'
    type: 'dword'
    data: '0'
  software\policies\microsoft\office\16.0\excel\security\trusted locations\alllocationsdisabled:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security\trusted locations'
    value: 'alllocationsdisabled'
    type: 'dword'
    data: '1'

acsc_e8_office_hardening::macros::trusted_locations:
  software\policies\microsoft\office\common\security\automationsecurity:
    class: 'user'
    key: 'software\policies\microsoft\office\common\security'
    value: 'automationsecurity'
    type: 'dword'
    data: '2'
  software\policies\microsoft\office\16.0\common\vbaoff:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\common'
    value: 'vbaoff'
    type: 'dword'
    data: '0'
  software\policies\microsoft\office\16.0\common\security\macroruntimescanscope:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\common\security'
    value: 'macroruntimescanscope'
    type: 'dword'
    data: '2'
  software\policies\microsoft\office\16.0\common\security\trusted locations\allow user locations:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\common\security\trusted locations'
    value: 'allow user locations'
    type: 'dword'
    data: '0'
  software\policies\microsoft\office\16.0\excel\security\excelbypassencryptedmacroscan:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security'
    value: 'excelbypassencryptedmacroscan'
    type: 'dword'
    data: '0'
  software\policies\microsoft\office\16.0\excel\security\blockcontentexecutionfrominternet:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security'
    value: 'blockcontentexecutionfrominternet'
    type: 'dword'
    data: '1'
  software\policies\microsoft\office\16.0\excel\security\accessvbom:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security'
    value: 'accessvbom'
    type: 'dword'
    data: '0'
  software\policies\microsoft\office\16.0\excel\security\trusted documents\disabletrusteddocuments:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security\trusted documents'
    value: 'disabletrusteddocuments'
    type: 'dword'
    data: '1'
  software\policies\microsoft\office\16.0\excel\security\trusted documents\disablenetworktrusteddocuments:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security\trusted documents'
    value: 'disablenetworktrusteddocuments'
    type: 'dword'
    data: '1'
  software\policies\microsoft\office\16.0\excel\security\vbawarnings:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security'
    value: 'vbawarnings'
    type: 'dword'
    data: '4'
  software\policies\microsoft\office\16.0\excel\security\trusted locations\allownetworklocations:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security\trusted locations'
    value: 'allownetworklocations'
    type: 'dword'
    data: '1'
  software\policies\microsoft\office\16.0\excel\security\trusted locations\alllocationsdisabled:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security\trusted locations'
    value: 'alllocationsdisabled'
    type: 'dword'
    data: '0'

acsc_e8_office_hardening::macros::signed_only:
  Software\Policies\Microsoft\Internet Explorer\Control Panel\ContentTab:
    class: 'both'
    key: 'Software\Policies\Microsoft\Internet Explorer\Control Panel'
    value: 'ContentTab'
    type: 'dword'
    data: '1'
  Software\Policies\Microsoft\MMC\{53D6AB1D-2488-11D1-A28C-00C04FB94F17}\Restrict_Run:
    class: 'user'
    key: 'Software\Policies\Microsoft\MMC\{53D6AB1D-2488-11D1-A28C-00C04FB94F17}'
    value: 'Restrict_Run'
    type: 'dword'
    data: '1'
  software\policies\microsoft\office\common\security\automationsecurity:
    class: 'user'
    key: 'software\policies\microsoft\office\common\security'
    value: 'automationsecurity'
    type: 'dword'
    data: '2'
  software\policies\microsoft\office\16.0\common\trustcenter\trustbar:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\common\trustcenter'
    value: 'trustbar'
    type: 'dword'
    data: '1'
  software\policies\microsoft\office\16.0\common\vbaoff:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\common'
    value: 'vbaoff'
    type: 'dword'
    data: '0'
  software\policies\microsoft\office\16.0\common\security\macroruntimescanscope:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\common\security'
    value: 'macroruntimescanscope'
    type: 'dword'
    data: '2'
  software\policies\microsoft\office\16.0\common\security\trusted locations\allow user locations:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\common\security\trusted locations'
    value: 'allow user locations'
    type: 'dword'
    data: '0'
  software\policies\microsoft\office\16.0\excel\disabledcmdbaritemslist\19092: # Confirm this works when this mode is used
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\disabledcmdbaritemslist'
    value: '19092'
    type: 'string'
  software\policies\microsoft\office\16.0\excel\security\excelbypassencryptedmacroscan:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security'
    value: 'excelbypassencryptedmacroscan'
    type: 'dword'
    data: '0'
  software\policies\microsoft\office\16.0\excel\security\blockcontentexecutionfrominternet:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security'
    value: 'blockcontentexecutionfrominternet'
    type: 'dword'
    data: '1'
  software\policies\microsoft\office\16.0\excel\security\accessvbom:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security'
    value: 'accessvbom'
    type: 'dword'
    data: '0'
  software\policies\microsoft\office\16.0\excel\security\trusted documents\disabletrusteddocuments:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security\trusted documents'
    value: 'disabletrusteddocuments'
    type: 'dword'
    data: '1'
  software\policies\microsoft\office\16.0\excel\security\trusted documents\disablenetworktrusteddocuments:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security\trusted documents'
    value: 'disablenetworktrusteddocuments'
    type: 'dword'
    data: '1'
  software\policies\microsoft\office\16.0\excel\security\vbawarnings:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security'
    value: 'vbawarnings'
    type: 'dword'
    data: '3'
  software\policies\microsoft\office\16.0\excel\security\trusted locations\allownetworklocations:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security\trusted locations'
    value: 'allownetworklocations'
    type: 'dword'
    data: '0'
  software\policies\microsoft\office\16.0\excel\security\trusted locations\alllocationsdisabled:
    class: 'user'
    key: 'software\policies\microsoft\office\16.0\excel\security\trusted locations'
    value: 'alllocationsdisabled'
    type: 'dword'
    data: '1'